{
    "name": "DemoK8AwsEks",
    "description": "Demo template for deploying test Pod in AWS EKS",
    "version": "1.0.0",
    "engine": "1.0.0",
    "release": "20241201",
    "requires": [],
    "stack": {
        "orchestrator": "Pulumi",
        "input": [
            {
                "type": "environment",
                "name": "PULUMI_CONFIG_PASSPHRASE"
            },
            {
                "type": "environment",
                "name": "PULUMI_BACKEND_URL"
            }
        ],
        "setup": [
            {
                "type": "environment",
                "name": "aws:region",
                "value": "AWS_REGION",
                "default": "us-east-1"
            },
            {
                "type": "protected",
                "name": "aws:accessKey",
                "value": "AWS_ACCESS_KEY_ID",
                "default": ""
            },
            {
                "type": "protected",
                "name": "aws:secretKey",
                "value": "AWS_SECRET_ACCESS_KEY",
                "default": ""
            }
        ],
        "components": [
            {
                "name": "Atlas",
                "input": [
                    {
                        "type": "value",
                        "name": "clusterType",
                        "value": "REPLICASET"
                    },
                    {
                        "type": "value",
                        "name": "replicationSpecs",
                        "value": [
                            {
                                "numShards": 1,
                                "regionsConfigs": [
                                    {
                                        "regionName": "US_EAST_1",
                                        "electableNodes": 3,
                                        "priority": 7,
                                        "readOnlyNodes": 0
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "type": "value",
                        "name": "cloudBackup",
                        "value": true
                    },
                    {
                        "type": "value",
                        "name": "autoScalingDiskGbEnabled",
                        "value": true
                    },
                    {
                        "type": "value",
                        "name": "mongoDbMajorVersion",
                        "value": "8.0"
                    },
                    {
                        "type": "value",
                        "name": "providerName",
                        "value": "AWS"
                    },
                    {
                        "type": "value",
                        "name": "providerInstanceSizeName",
                        "value": "M20"
                    }
                ],
                "output": [
                    {
                        "type": "reference",
                        "name": "connectionString",
                        "value": "connectionString",
                        "description": "Connection string of the HelloWorld component"
                    },
                    {
                        "type": "reference",
                        "name": "clusterId",
                        "value": "clusterId",
                        "description": "ID of the Atlas cluster"
                    }
                ],
                "setup": [
                    {
                        "type": "secret",
                        "name": "mongodb-atlas:publicKey",
                        "value": "ATLAS_PUBLIC_KEY"
                    },
                    {
                        "type": "secret",
                        "name": "mongodb-atlas:privateKey",
                        "value": "ATLAS_PRIVATE_KEY"
                    },
                    {
                        "type": "secret",
                        "name": "mongodb-atlas:projectId",
                        "value": "ATLAS_PROJECT_ID"
                    }
                ]
            },
            {
                "name": "K8Pods",
                "input": [
                    {
                        "type": "value",
                        "name": "containerName",
                        "value": "ditto-demo"
                    },
                    {
                        "type": "value",
                        "name": "image",
                        "value": "275662791714.dkr.ecr.us-east-1.amazonaws.com/sa-demo/ditto-vehicle-digital-twin-feedback-loop:latest"
                    },
                    {
                        "type": "environment",
                        "name": "DITTO_WEBSOCKET_URL",
                        "value": "DITTO_WEBSOCKET_URL"
                    },
                    {
                        "type": "environment",
                        "name": "DITTO_CUSTOM_AUTH_URL",
                        "value": "DITTO_CUSTOM_AUTH_URL"
                    },
                    {
                        "type": "environment",
                        "name": "DITTO_PLAYGROUND_TOKEN",
                        "value": "DITTO_PLAYGROUND_TOKEN"
                    },
                    {
                        "type": "environment",
                        "name": "DITTO_APP_ID",
                        "value": "DITTO_APP_ID"
                    }
                ],
                "output": [
                    {
                        "type": "reference",
                        "name": "ipAddress",
                        "value": "ipAddress",
                        "description": "IP address of the K8Pods component"
                    },
                    {
                        "type": "value",
                        "name": "message",
                        "value": "${ipAddress} - Pod is running",
                        "description": "Message indicating the Pod is running"
                    }
                ],
                "setup": []
            }
        ]
    }
}