{
    "name": "DittoEcrDockerDemo",
    "description": "Demo: create ECR repo, build+push Docker image from GitHub, deploy to EKS",
    "version": "1.0.0",
    "engine": "1.0.0",
    "release": "20241201",
    "requires": [],
    "stack": {
        "orchestrator": "Pulumi",
        "input": [
            {
                "type": "environment",
                "name": "PULUMI_CONFIG_PASSPHRASE"
            },
            {
                "type": "environment",
                "name": "PULUMI_BACKEND_URL"
            }
        ],
        "setup": [
            {
                "type": "environment",
                "name": "aws:region",
                "value": "AWS_REGION",
                "default": "us-east-1"
            },
            {
                "type": "protected",
                "name": "aws:accessKey",
                "value": "AWS_ACCESS_KEY_ID",
                "default": ""
            },
            {
                "type": "protected",
                "name": "aws:secretKey",
                "value": "AWS_SECRET_ACCESS_KEY",
                "default": ""
            }
        ],
        "components": [
            {
                "name": "ECR",
                "input": [
                    {
                        "type": "value",
                        "name": "repositoryName",
                        "value": "sa-demo/ditto-vehicle-digital-twin-feedback-loop"
                    },
                    {
                        "type": "environment",
                        "name": "region",
                        "value": "AWS_REGION"
                    }
                ]
            },
            {
                "name": "Docker",
                "input": [
                    {
                        "type": "value",
                        "name": "repoUrl",
                        "value": "https://github.com/mongodb-industry-solutions/vehicle-digital-twin-feedback-loop.git"
                    },
                    {
                        "type": "value",
                        "name": "gitRef",
                        "value": "main"
                    },
                    {
                        "type": "value",
                        "name": "contextPath",
                        "value": "vehicle-ts"
                    },
                    {
                        "type": "value",
                        "name": "dockerfile",
                        "value": "Dockerfile"
                    },
                    {
                        "type": "reference",
                        "name": "registryUrl",
                        "value": "repositoryUrl"
                    },
                    {
                        "type": "value",
                        "name": "imageTag",
                        "value": "latest"
                    },
                    {
                        "type": "environment",
                        "name": "githubToken",
                        "value": "GITHUB_TOKEN"
                    }
                ]
            }
        ]
    }
}